# 基本原理（Design Principles）
# このファイルがSSoTであり、各ツール向けルールはここから自動生成される

version: "0.1"
last_updated: "2026-01-26"

principles:
  P1:
    id: "P1"
    name: "コンテキスト競合の排除"
    short_name: "SubAgent前提"
    description: |
      AI活用が進むほど、単一エージェントの巨大コンテキストは破綻しやすい。
      よって、役割分離された複数サブエージェントの同時稼働を前提とし、
      コンテキストを侵食し合わない構造で品質と速度を上げる。
    rules:
      - "単一エージェントに全文脈を詰め込まない"
      - "役割ごとにサブエージェントを分離する"
      - "サブエージェント間は成果物（中間生成物）で受け渡す"
      - "並列稼働を前提とし、主コンテキストを侵食しない"
    anti_patterns:
      - "一つのプロンプトに全情報を詰め込む"
      - "エージェントの役割が曖昧なまま進める"

  P2:
    id: "P2"
    name: "中間生成物で合意を運ぶ"
    short_name: "Righting Software踏襲"
    description: |
      コードレビューだけではなく、契約・失敗モード・テスト戦略・計測設計といった
      中間生成物で「意図と根拠」を検査可能にする。
      曖昧→抽象合意→具体化→実装、という往復運動を成果物で管理する。
    rules:
      - "コードの前に中間生成物（契約、失敗モード、テスト戦略、計測設計）を作成する"
      - "レビューはコードだけでなく中間生成物も対象とする"
      - "意図と根拠を検査可能な形で残す"
    intermediate_artifacts:
      - name: "契約"
        description: "API/イベント/データの入出力仕様"
      - name: "失敗モード"
        description: "何が壊れうるか、その影響と対策"
      - name: "テスト戦略"
        description: "何が証明書になるか、どのレベルで検証するか"
      - name: "計測設計"
        description: "成功/失敗を何で判定するか"
    anti_patterns:
      - "コードを書いてからテストを考える"
      - "レビューでコードの見た目だけを見る"

  P3:
    id: "P3"
    name: "ストラングラの目的は道具を減らすこと"
    short_name: "道具削減"
    description: |
      リアーキは段階移行を基本とし、各スライスごとに「減らせる道具／消せる構成」を必ず評価する。
      統合すべきか分割すべきかの判断も、エージェントが検査・提案できるようにする。
    rules:
      - "各スライスで「何を減らせるか」を必ず評価する"
      - "削除対象を明確にする（古いエンドポイント、フラグ、設定、スクリプト、依存）"
      - "代替経路が証明されてから削除する（新経路のテストが通っている）"
      - "ロールバック手段を確保する（フラグ/段階展開/互換性）"
    deletion_conditions:
      - "削除対象が明確である"
      - "代替経路が証明されている（新経路のテストが通っている）"
      - "ロールバックがある（フラグ/段階展開/互換性）"
      - "影響範囲が見えている（契約と依存が書かれている）"
    anti_patterns:
      - "新しい経路を作るだけで古い経路を残す"
      - "削除を後回しにし続ける"

  P4:
    id: "P4"
    name: "ルール／知識は育つ資産として継続適用される"
    short_name: "知識資産化"
    description: |
      環境構築の暗黙知、結合の作法、チーム固有の留意点などは、
      都度チャットで消費せず、ルール／スキル／ナレッジとして蓄積し、
      以後の作業に自動適用される仕組みにする。
    rules:
      - "知見はチャットで消費せず、ルール/スキル/ナレッジとして蓄積する"
      - "蓄積した知識は以後の作業に自動適用される"
      - "SSoTに集約し、ダブルメンテを禁止する"
    knowledge_types:
      - name: "ルール"
        description: "常に適用される制約や作法"
        example: "コミットメッセージの形式、レビュー観点"
      - name: "スキル"
        description: "特定の作業を行う手順や知識"
        example: "環境構築手順、デプロイ手順"
      - name: "ナレッジ"
        description: "参照用の情報や過去の学習"
        example: "失敗事例、ベストプラクティス"
    anti_patterns:
      - "同じ説明を毎回チャットで繰り返す"
      - "複数の場所に同じ知識を書く（ダブルメンテ）"

# P5以降は組織固有の原理として _config/org/ で定義可能
