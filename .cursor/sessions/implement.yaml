# Implement Session
# 仕様の実現のための場
# 設計済みの仕様を実装する

id: implement

purpose: "仕様の実現"

description: |
  決定的に解ける作業を行う場。
  設計が完了した仕様を忠実に実装し、
  watcher が品質を検査する。

# 参加者構成
participants:
  executor:
    role: "実装者"
    perspective: "実装、作成"
    examples:
      - "一般的な実装者ロール"
      - "人格は通常不要（Task Classifier が判断）"
  watcher:
    role: "検査者"
    perspective: "品質、整合性"
    examples:
      - "一般的な検査者ロール"
      - "人格は通常不要（Task Classifier が判断）"

# 人格インストール
persona:
  required: false  # Task Classifier が判断
  selection_axes: []
  rationale: |
    実装タスクは決定的に解ける。
    ただし、Task Classifier が「判断が必要」と判定した場合は
    人格インストールが適用される。

# イテレーション
iterations:
  min: 1
  max: 2
  criteria: "watcher が pass するまで"
  rationale: |
    実装は1回で完了することが多い。
    watcher が issues を出した場合のみ2回目。

# 入出力
inputs:
  - "設計書（何を作るか）"
  - "受け入れ基準（何をもって完了とするか）"
  - "テスト戦略（どう検証するか）"

outputs:
  - "artifacts（コード、ドキュメント、設定など）"
  - "検証レポート（テスト結果、品質確認）"

# 終了条件
completion:
  success: "watcher が pass 判定し、受け入れ基準を満たす"
  escalation: "2イテレーションで pass できない場合、design に戻る"

# 遷移
transitions:
  on_success: "次のタスク または retrospective"
  on_issues: "design（設計の見直しが必要な場合）"

# 検査観点
inspection:
  - "受け入れ基準を満たしているか"
  - "artifacts が期待通りに動作するか"
  - "設計書との整合性"

# Task Classifier 判定ルール
task_classifier_override:
  persona_required_if:
    - "実装中に設計判断が必要になった"
    - "複数の実装アプローチが考えられる"
    - "品質と速度のトレードオフがある"
