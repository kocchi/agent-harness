# Insight Contract for Sprint 3
# Created: 2026-01-30

insights:
  - id: "INS-20260130-001"
    insight:
      statement: "slice スキルで「未知」を分析し「既知」に変えるプロセス自体がリスク低減になる"
      source: "スライス完了"
      evidence:
        summary: "S2, S3 を最初「未知」と分類したが、スキル内容を読んで分析した結果、全て「既知」に変わった"
        references:
          - type: "file"
            path: "contracts/slice-contract-S3-skill-cleanup.yaml"
            description: "classification_rationale に分析プロセスを記録"
      confidence: "high"
    impact:
      affects:
        - "slice スキルの価値説明"
        - "契約体系のドキュメント"
      action_required: false
      urgency: "low"
    next_action:
      type: "knowledge"
      description: "slice スキルの説明に「分析による未知→既知変換」の価値を追記"
      owner: "Yuki"
      deadline: null
    status: "validated"
    created_at: "2026-01-30"

  - id: "INS-20260130-002"
    insight:
      statement: "契約体系と Git ワークフローは自然に対応する: Increment = ブランチ/PR、コミット = 論理的変更"
      source: "スライス完了"
      evidence:
        summary: "sprint-goal-contract-S3 に git_workflow を定義し、実際に運用して問題なく機能した"
        references:
          - type: "file"
            path: "contracts/sprint-goal-contract-S3.yaml"
            description: "git_workflow セクション"
      confidence: "high"
    impact:
      affects:
        - "ブランチ戦略のドキュメント"
        - "VISION.md"
      action_required: true
      urgency: "medium"
    next_action:
      type: "docs"
      description: "VISION.md に git_workflow との対応を追記"
      owner: "Yuki"
      deadline: "2026-02-06"
    status: "applied"
    created_at: "2026-01-30"

  - id: "INS-20260130-003"
    insight:
      statement: "ローカルで大きな構造変更をしている間に origin が進むと、リベース/マージが複雑化する"
      source: "スライス完了"
      evidence:
        summary: "origin/master と 27 コミット差があり、.cursor/ 移行でコンフリクト多発。最終的に force push で解決"
        references: []
      confidence: "high"
    impact:
      affects:
        - "コミット戦略"
        - "プッシュ頻度"
      action_required: true
      urgency: "high"
    next_action:
      type: "rule"
      description: "「小さな単位で頻繁にプッシュ」をルールに追加検討"
      owner: "Yuki"
      deadline: "2026-02-06"
    status: "applied"
    created_at: "2026-01-30"

  - id: "INS-20260130-004"
    insight:
      statement: "ドッグフーディングにより契約体系の実用性を確認できた（H1 の初期検証）"
      source: "Retro"
      evidence:
        summary: "slice-contract → 実装 → コミット → PR → マージの流れを1タスクで完走"
        references:
          - type: "url"
            path: "https://github.com/kocchi/agent-harness/pull/1"
            description: "S3 Increment 1 の PR"
      confidence: "medium"
    impact:
      affects:
        - "product-goal-contract の仮説 H1"
      action_required: false
      urgency: "low"
    next_action:
      type: "none"
      description: "継続的にデータ収集"
      owner: null
      deadline: null
    status: "validated"
    created_at: "2026-01-30"

  - id: "INS-20260130-005"
    insight:
      statement: "既存スキル（task-orchestrator, session-selector, propose-change）は契約体系と競合せず、レイヤーが異なる補完関係"
      source: "スライス完了"
      evidence:
        summary: "4つの Increment で既存スキルを分析。全て「レイヤー違いで補完関係」と判明"
        references:
          - type: "url"
            path: "https://github.com/kocchi/agent-harness/pull/2"
            description: "task-orchestrator integration"
          - type: "url"
            path: "https://github.com/kocchi/agent-harness/pull/3"
            description: "session-selector integration"
          - type: "url"
            path: "https://github.com/kocchi/agent-harness/pull/4"
            description: "propose-change update"
      confidence: "high"
    impact:
      affects:
        - "skills-inventory.md"
        - "スキル整理方針"
      action_required: false
      urgency: "low"
    next_action:
      type: "none"
      description: "方針として確定"
      owner: null
      deadline: null
    status: "validated"
    created_at: "2026-01-30"

summary:
  total_insights: 5
  validated: 3
  applied: 2
  key_learnings:
    - "slice の「未知→既知」変換プロセスがリスク低減になる"
    - "契約体系と Git ワークフローは自然に対応"
    - "小さな単位で頻繁にプッシュすべき"
    - "ドッグフーディングで H1 の初期検証完了"
    - "既存スキルは契約体系と補完関係（レイヤー違い）"

sprint_summary:
  increments_completed: 4
  prs_merged:
    - "https://github.com/kocchi/agent-harness/pull/1"
    - "https://github.com/kocchi/agent-harness/pull/2"
    - "https://github.com/kocchi/agent-harness/pull/3"
    - "https://github.com/kocchi/agent-harness/pull/4"
  goal_achieved: true

retro:
  keep:
    - "slice スキルでの価値分類"
    - "コミット前レビュー（中間生成物での合意）"
    - "ブランチ戦略の明文化"
    - "Increment 完了ごとの即プッシュ（新ルール適用）"
  problem:
    - "origin/master との乖離（解決済み: force push + 新ルール）"
  try:
    - "次のスプリントで別リポジトリ（歩活等）でドッグフーディング"
    - "improvement-lifecycle スキルの整理"
